<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Verifying Access...</title>
  <script>
    const key = new URLSearchParams(window.location.search).get("key");

    if (key === "unlocked") {
      const expiry = Date.now() + 24 * 60 * 60 * 1000;
      localStorage.setItem("verified_access", expiry.toString());
      window.location.href = "/index.html";
    } else {
      const apiToken = "5fb415cd7e6b42fd8ba25416066c25f44c85587b";
      const redirectURL = encodeURIComponent("https://alphalinkz.netlify.app/verify.html?key=unlocked");
      const apiURL = `https://linkshortify.com/api?api=${apiToken}&url=${redirectURL}`;

      fetch(apiURL)
        .then(res => res.json())
        .then(data => {
          if (data.shortenedUrl) {
            window.location.href = data.shortenedUrl;
          } else {
            document.body.innerHTML = `<h2>Error: ${data.message || "Shortening failed"}</h2>`;
          }
        })
        .catch(err => {
          console.error(err);
          document.body.innerHTML = "<h2>Network error. Try again later.</h2>";
        });
    }
  </script>
  <style>
    body {
      background: #121212;
      color: white;
      font-family: sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    h2 { text-align: center; }
  </style>
</head>
<body>
  <h2>Verifying your access...</h2>
</body>
</html>
